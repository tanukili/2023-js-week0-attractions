import{_ as a,o as c,c as n,a as i,t as r,w as h,n as d,b as u}from"./index-ff41197e.js";const w={data(){return{view:{viewId:null},isCollected:!1,isClick:!1}},methods:{render(e){this.axios.get(`http://localhost:3000/views/${e}`).then(s=>{this.view={...this.view,...s.data},this.view.id=null})},addCollect(){if(this.isCollected&&this.view.userId){alert("已加入收藏");return}const e=document.cookie.replace(/(?:(?:^|.*;\s*)userToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.axios.post("http://localhost:3000/600/collects",this.view,{headers:{authorization:`Bearer ${e}`}}).then(()=>{alert("加入成功"),this.isCollected=!0}).catch(()=>{alert("請先登入"),this.$router.push("/login")})},checkCollects(){this.axios.get(`http://localhost:3000/collects?userId=${this.view.userId}`).then(e=>{!!e.data.find(this.a)&&(this.isCollected=!0,this.isClick=!0)}).catch(e=>{console.log(e)})},a(e){return e.viewId===this.view.viewId}},mounted(){const e=window.location.href.split("=")[1];this.view.viewId=e;const s=document.cookie.replace(/(?:(?:^|.*;\s*)userId\s*=\s*([^;]*).*$)|^.*$/,"$1");this.view.userId=s,this.render(e),this.checkCollects()}},v={class:"container mt-5"},p=i("h1",null,"景點詳細",-1),C={class:"fw-bold"};function k(e,s,f,m,t,o){return c(),n("div",v,[p,i("h2",C,r(t.view.name),1),i("p",null,r(t.view.description),1),t.view.userId!==""?(c(),n("a",{key:0,href:"#",onClick:s[1]||(s[1]=h((...l)=>o.addCollect&&o.addCollect(...l),["prevent"]))},[i("span",{class:d({"d-none":!t.isClick})},"已收藏",2),i("span",{class:d({"d-none":t.isClick}),onClick:s[0]||(s[0]=l=>t.isClick=!t.isClick)},"加入收藏",2)])):u("",!0)])}const _=a(w,[["render",k]]);export{_ as default};
